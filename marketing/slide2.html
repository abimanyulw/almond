<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Almond Polaroid Cam â€” Sort Letters Game</title>

  <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@300;400;600&family=Yeseva+One&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg: #1E2A36;
      --accent: #D6A889;
      --muted: rgba(214,168,137,0.08);
      --card-padding-desktop: 24px;
      --card-padding-mobile: 12px;
      --letter-size-desktop: 42px;
      --letter-size-mobile: 54px;
      --slot-size-desktop: 36px;
      --slot-size-mobile: 48px;
      --gap: 8px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:flex-start;
      justify-content:center;
      background: radial-gradient(1200px 600px at 10% 10%, rgba(214,168,137,0.03), transparent 8%),
                  linear-gradient(180deg, var(--bg), #122029 140%);
      color:var(--accent);
      font-family: "Josefin Sans", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:12px;
      overflow-x: hidden; /* prevent horizontal overflow */
    }

    .card {
      width:100%;
      max-width:820px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:14px;
      padding:var(--card-padding-desktop);
      box-shadow: 0 10px 30px rgba(2,6,10,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
      border: 1px solid rgba(214,168,137,0.12);
      margin: 12px 0;
    }

    /* hide header/title per request */
    header { display: none; }

    .game { margin-top:6px; display:flex; flex-direction:column; gap:14px; }

    /* word row block */
    .word-block {
      display:flex;
      gap:12px;
      align-items:center;
      background: linear-gradient(180deg, rgba(214,168,137,0.02), transparent);
      padding:10px;
      border-radius:10px;
      border:1px dashed rgba(214,168,137,0.06);
      flex-wrap:nowrap;
      min-width:0;
    }

    .label {
      min-width:100px;
      font-weight:600;
      color:var(--accent);
      font-size:14px;
      flex: 0 0 100px;
    }

    .target {
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:nowrap;
      min-height:44px;
      flex: 1 1 auto;
      justify-content:flex-start;
      min-width:0; /* prevents overflow */
      overflow-x:auto;
      padding-bottom:2px;
    }

    /* letters container: desktop uses wrap flex, mobile uses grid (see media) */
    .letters-container {
      display:flex;
      gap:var(--gap);
      align-items:center;
      justify-content:flex-start;
      flex-wrap:wrap;
      padding-left:6px;
      flex: 0 0 auto;
      min-width:0;
    }

    .letter-btn {
      background-color: #d2ac95;
      color: #1f2a35;
      border: 2px solid #d2ac95;
      padding: 6px 8px;
      margin: 4px;
      border-radius: 8px;
      cursor: pointer;
      font-family: 'Josefin Sans', sans-serif;
      font-size: 16px;
      min-width: var(--letter-size-desktop);
      height: var(--letter-size-desktop);
      display:inline-flex;
      align-items:center;
      justify-content:center;
      user-select:none;
      touch-action: manipulation;
      text-transform: uppercase;
    }
    .letter-btn:hover {
      background-color: #1f2a35;
      color: #d2ac95;
      outline: solid 2px #d2ac95;
    }
    .letter-btn.disabled {
      opacity: 0.36;
      cursor: default;
      transform: scale(0.98);
    }

    .slot {
      min-width: var(--slot-size-desktop);
      min-height: var(--slot-size-desktop);
      border-radius:8px;
      border: 2px dashed rgba(214,168,137,0.14);
      display:flex;
      align-items:center;
      justify-content:center;
      color:var(--accent);
      font-weight:700;
      font-size:16px;
      background: rgba(255,255,255,0.01);
      padding:6px 8px;
      text-transform: uppercase;
    }

    .controls {
      display:flex;
      gap:10px;
      justify-content:center;
      margin-top:10px;
      flex-wrap:wrap;
    }

    .btn-start {
      background: #d2ac95;
      color: #1f2a35;
      font-size: 0.95em;
      padding: 10px 14px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-family: 'Josefin Sans', sans-serif;
      min-height:44px;
      min-width:94px;
    }
    .btn-start:hover {
      background-color: #1f2a35;
      color: #d2ac95;
      outline: solid 2px #d2ac95;
    }

    .message {
      margin-top:12px;
      padding:12px;
      border-radius:10px;
      background: var(--muted);
      color: var(--accent);
      font-weight:600;
      text-align:center;
    }

    /* Mobile: stack and use grid for letters so they never overflow horizontally */
    @media (max-width:720px){
      .card { padding: var(--card-padding-mobile); max-width:520px; }
      .word-block { flex-direction:column; align-items:flex-start; gap:10px; padding:12px; }
      .label { display:none; } /* free space */
      .target { justify-content:center; gap:10px; overflow-x:auto; width:100%; min-width:0; }
      .letters-container {
        display:grid;
        grid-template-columns: repeat(auto-fit, minmax(48px, 1fr));
        gap:8px;
        width:100%;
        padding-left:0;
      }
      .letter-btn { min-width:0; width:100%; height: var(--letter-size-mobile); font-size:18px; border-radius:10px; padding:0; margin:0; }
      .slot { min-width: var(--slot-size-mobile); min-height: var(--slot-size-mobile); font-size:18px; border-radius:10px; }
      .controls { justify-content:space-between; gap:8px; }
      .message { font-size:14px; padding:10px; }
    }

    /* touch highlight */
    .letter-btn, .btn-start { -webkit-tap-highlight-color: rgba(0,0,0,0.15); }
  </style>
</head>
<body>
  <div class="card" role="main">
    <section class="game" id="game">
      <div class="word-block" data-word-index="0">
        <div class="label" aria-hidden="true">Word 1</div>
        <div class="target" id="target-0" aria-label="target word 1"></div>
        <div id="letters-0" class="letters-container" aria-label="letters for word 1"></div>
      </div>

      <div class="word-block" data-word-index="1">
        <div class="label" aria-hidden="true">Word 2</div>
        <div class="target" id="target-1" aria-label="target word 2"></div>
        <div id="letters-1" class="letters-container" aria-label="letters for word 2"></div>
      </div>

      <div class="word-block" data-word-index="2">
        <div class="label" aria-hidden="true">Word 3</div>
        <div class="target" id="target-2" aria-label="target word 3"></div>
        <div id="letters-2" class="letters-container" aria-label="letters for word 3"></div>
      </div>

      <div class="controls">
        <button class="btn-start" id="undoBtn" type="button">Undo</button>
        <button class="btn-start" id="resetBtn" type="button">Reset</button>
        <button class="btn-start" id="checkBtn" type="button">Check</button>
      </div>

      <div id="message" class="message" style="display:none" role="status"></div>
    </section>
  </div>

  <script>
    const words = ["ALMOND", "POLAROID", "CAM"];

    function shuffle(a) {
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    const placed = words.map(w => []);
    const history = [];

    function createLetterButtons() {
      words.forEach((w, wi) => {
        const container = document.getElementById('letters-' + wi);
        container.innerHTML = '';

        let chars = w.split('');
        chars = shuffle(chars.slice());

        chars.forEach((ch, idx) => {
          const btn = document.createElement('button');
          btn.className = 'letter-btn';
          btn.type = 'button';
          btn.textContent = ch;
          const id = `w${wi}-c${idx}`;
          btn.id = id;
          btn.dataset.letter = ch;
          btn.dataset.wordIndex = wi;
          btn.onclick = () => onLetterClick(wi, id);
          container.appendChild(btn);
        });

        const target = document.getElementById('target-' + wi);
        target.innerHTML = '';
        for (let i = 0; i < w.length; i++) {
          const slot = document.createElement('div');
          slot.className = 'slot';
          slot.dataset.index = i;
          slot.dataset.wordIndex = wi;
          slot.textContent = '';
          target.appendChild(slot);
          placed[wi][i] = null;
        }
      });

      history.length = 0;
      showMessage('', false);
    }

    function onLetterClick(wordIndex, btnId) {
      const btn = document.getElementById(btnId);
      if (!btn || btn.classList.contains('disabled')) return;

      const slotIndex = placed[wordIndex].indexOf(null);
      if (slotIndex === -1) {
        showMessage('This word is already complete. Use undo or reset to change.', true);
        return;
      }

      const ch = btn.dataset.letter;
      const slot = document.querySelector(`#target-${wordIndex} .slot[data-index="${slotIndex}"]`);
      slot.textContent = ch;
      placed[wordIndex][slotIndex] = { ch, btnId };

      btn.classList.add('disabled');
      btn.disabled = true;

      history.push({ wordIndex, slotIndex, btnId });

      showMessage('', false);
    }

    document.getElementById('undoBtn').addEventListener('click', () => {
      if (history.length === 0) {
        showMessage('Nothing to undo.', true);
        return;
      }
      const last = history.pop();
      const { wordIndex, slotIndex, btnId } = last;
      const slot = document.querySelector(`#target-${wordIndex} .slot[data-index="${slotIndex}"]`);
      if (slot) slot.textContent = '';
      placed[wi = wordIndex][slotIndex] = null;
      const btn = document.getElementById(btnId);
      if (btn) {
        btn.classList.remove('disabled');
        btn.disabled = false;
      }
      showMessage('', false);
    });

    document.getElementById('resetBtn').addEventListener('click', () => {
      createLetterButtons();
    });

    document.getElementById('checkBtn').addEventListener('click', () => {
      const formed = placed.map((arr, i) => {
        if (arr.some(a => a === null)) return null;
        return arr.map(a => a.ch).join('');
      });

      if (formed.some(f => f === null)) {
        showMessage('Complete all three words before checking.', true);
        return;
      }

      const correct = formed.every((f, i) => f.toUpperCase() === words[i].toUpperCase());
      if (correct) {
        showMessage('Correct! Phrase formed: Almond Polaroid Cam', false);
      } else {
        const wrongIndices = formed.map((f,i) => f.toUpperCase() === words[i].toUpperCase() ? null : i).filter(x=>x!==null);
        showMessage('Some words are incorrect. Try again. Incorrect word(s): ' + wrongIndices.map(i => i+1).join(', '), true);
      }
    });

    function showMessage(text, isError) {
      const el = document.getElementById('message');
      if (!text) {
        el.style.display = 'none';
        el.textContent = '';
        return;
      }
      el.style.display = 'block';
      el.textContent = text;
      if (isError) {
        el.style.background = 'rgba(255,100,100,0.08)';
        el.style.color = 'rgba(255,180,180,0.95)';
      } else {
        el.style.background = 'rgba(214,168,137,0.08)';
        el.style.color = 'var(--accent)';
      }
    }

    // initialize
    createLetterButtons();

    // on resize, keep focused item visible
    window.addEventListener('resize', () => {
      document.activeElement && document.activeElement.scrollIntoView && document.activeElement.scrollIntoView({behavior:'smooth', block:'center'});
    });
  </script>
</body>
</html>
